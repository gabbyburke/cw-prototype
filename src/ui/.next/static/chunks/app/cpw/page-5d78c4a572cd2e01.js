(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[932],{6315:function(e,s,a){Promise.resolve().then(a.bind(a,3601))},3601:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return l}});var n=a(7437),r=a(2265),i=a(7648),t=a(9116);function c(e){let{isOpen:s,onClose:a,case_:i,onSuccess:c}=e,[l,d]=(0,r.useState)(1),[o,h]=(0,r.useState)(!1),[m,u]=(0,r.useState)(null),[p,x]=(0,r.useState)([]),[j,v]=(0,r.useState)(!1),[g,N]=(0,r.useState)(!1),[f,_]=(0,r.useState)(""),[y,b]=(0,r.useState)([]),[C,k]=(0,r.useState)(!1),[w,S]=(0,r.useState)("Parent"),[A,P]=(0,r.useState)(null),[R,q]=(0,r.useState)({first_name:"",last_name:"",date_of_birth:"",role:"Parent"}),[I,W]=(0,r.useState)({type:"",description:""}),[T,D]=(0,r.useState)({risk_level:"Medium",safety_factors:[],risk_confirmed:!1,safety_confirmed:!1}),[M,E]=(0,r.useState)({cpw_notes:"",ready_for_assignment:!1}),O=[{id:1,title:"Verify Case Membership",description:"Review and add people involved in the case",completed:p.length>0},{id:2,title:"Confirm Allegations",description:"Review and update case allegations",completed:""!==I.type&&""!==I.description},{id:3,title:"Confirm Assessments",description:"Review risk and safety assessments",completed:T.risk_confirmed&&T.safety_confirmed},{id:4,title:"Request SWCM Assignment",description:"Finalize case setup and request SWCM",completed:M.ready_for_assignment}],F=e=>"cpw_setup_".concat(e),L=()=>{if(!i)return;let e={caseId:i.case_id,currentStep:l,casePersons:p,allegations:I,assessments:T,finalConfirmation:M,lastSaved:new Date().toISOString()};localStorage.setItem(F(i.case_id),JSON.stringify(e))},U=e=>{try{let s=localStorage.getItem(F(e));return s?JSON.parse(s):null}catch(e){return console.error("Error loading saved progress:",e),null}},B=e=>{localStorage.removeItem(F(e))};(0,r.useEffect)(()=>{if(s&&i){let e=U(i.case_id);e?(d(e.currentStep),x(e.casePersons),W(e.allegations),D(e.assessments),E(e.finalConfirmation)):(x(i.persons||[]),W({type:i.allegation_type||"",description:i.allegation_description||""}),D({risk_level:i.risk_level||"Medium",safety_factors:i.safety_factors||[],risk_confirmed:!1,safety_confirmed:!1}),E({cpw_notes:"",ready_for_assignment:!1}),d(1)),u(null)}},[s,i]),(0,r.useEffect)(()=>{if(s&&i){let e=setTimeout(()=>{L()},1e3);return()=>clearTimeout(e)}},[s,i,l,p,I,T,M]);let J=e=>{x(p.filter(s=>s.person_id!==e))},V=async e=>{if(e.length<2){b([]);return}k(!0);try{let s=await (0,t.Kj)(e);s.error?(u(s.error),b([])):s.data&&b(s.data.persons)}catch(e){u("Failed to search persons"),b([])}finally{k(!1)}},G=e=>{if(p.some(s=>s.person_id===e.person_id)){u("This person is already added to the case");return}x([...p,{...e,role:w.toLowerCase(),relationship_to_primary_child:w}]),N(!1),_(""),b([]),u(null)};(0,r.useEffect)(()=>{if(f){let e=setTimeout(()=>{V(f)},300);return()=>clearTimeout(e)}b([])},[f]);let H=async()=>{if(i){h(!0),u(null);try{let e={allegation_type:I.type,allegation_description:I.description,status:"Pending Assignment"},s=await (0,t.$4)(i.case_id,e);s.error?u(s.error):(B(i.case_id),c(),a())}catch(e){u("Failed to complete case setup")}finally{h(!1)}}};return s&&i?(0,n.jsx)("div",{className:"modal-overlay",children:(0,n.jsxs)("div",{className:"modal-container large",children:[(0,n.jsxs)("div",{className:"modal-header",children:[(0,n.jsxs)("h2",{children:["CPW Case Setup - ",i.case_display_name||"Case ".concat(i.case_id)]}),(0,n.jsx)("button",{onClick:a,className:"modal-close",children:(0,n.jsx)("span",{className:"icon",children:"close"})})]}),(0,n.jsx)("div",{className:"setup-progress",children:O.map(e=>(0,n.jsxs)("div",{className:"progress-step ".concat(l===e.id?"active":""," ").concat(e.completed?"completed":""),children:[(0,n.jsx)("div",{className:"step-number",children:e.completed?(0,n.jsx)("span",{className:"icon",children:"check"}):e.id}),(0,n.jsxs)("div",{className:"step-info",children:[(0,n.jsx)("h4",{children:e.title}),(0,n.jsx)("p",{children:e.description})]})]},e.id))}),(0,n.jsxs)("div",{className:"modal-content",children:[m&&(0,n.jsxs)("div",{className:"error-message",children:[(0,n.jsx)("span",{className:"icon",children:"error"}),m]}),1===l&&(0,n.jsxs)("div",{className:"setup-step",children:[(0,n.jsx)("h3",{children:"Step 1: Verify Case Membership"}),(0,n.jsx)("p",{children:"Review the people involved in this case and add any missing individuals."}),(0,n.jsx)("div",{className:"persons-list",children:p.map(e=>(0,n.jsxs)("div",{className:"person-item",children:[(0,n.jsxs)("div",{className:"person-info",children:[(0,n.jsxs)("strong",{children:[e.first_name," ",e.last_name]}),(0,n.jsx)("span",{className:"person-role",children:e.role}),e.date_of_birth&&(0,n.jsxs)("span",{className:"person-age",children:["Age: ",Math.floor((new Date().getTime()-new Date(e.date_of_birth).getTime())/315576e5)]})]}),(0,n.jsxs)("button",{onClick:()=>J(e.person_id),className:"action-btn small error",children:[(0,n.jsx)("span",{className:"icon",children:"remove"}),"Remove"]})]},e.person_id))}),(0,n.jsxs)("div",{className:"person-search-section",children:[(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Search for a person or add new"}),(0,n.jsx)("input",{type:"text",value:f,onChange:e=>_(e.target.value),placeholder:"Start typing a person's name..."})]}),C&&(0,n.jsxs)("div",{className:"search-loading",children:[(0,n.jsx)("span",{className:"icon",children:"hourglass_empty"}),"Searching..."]}),y.length>0&&(0,n.jsxs)("div",{className:"search-results",children:[(0,n.jsxs)("h5",{children:["Found ",y.length," person(s)"]}),y.map(e=>{var s;return(0,n.jsxs)("div",{className:"search-result-item",children:[(0,n.jsxs)("div",{className:"person-info",children:[(0,n.jsxs)("strong",{children:[e.first_name," ",e.last_name]}),e.date_of_birth&&(0,n.jsxs)("span",{className:"person-age",children:["Age: ",Math.floor((new Date().getTime()-new Date(e.date_of_birth).getTime())/315576e5)]}),(null===(s=e.contact_info)||void 0===s?void 0:s.address)&&(0,n.jsx)("span",{className:"person-address",children:e.contact_info.address})]}),(0,n.jsx)("button",{onClick:()=>{p.some(s=>s.person_id===e.person_id)||(N(!0),S("Parent"),P(e))},className:"action-btn small primary",disabled:p.some(s=>s.person_id===e.person_id),children:p.some(s=>s.person_id===e.person_id)?"Already Added":"Select"})]},e.person_id)})]}),f.length>=2&&!C&&0===y.length&&(0,n.jsx)("div",{className:"no-results",children:(0,n.jsxs)("div",{className:"no-results-content",children:[(0,n.jsx)("span",{className:"icon",children:"search_off"}),(0,n.jsxs)("p",{children:['No persons found matching "',f,'"']}),(0,n.jsxs)("button",{onClick:()=>v(!0),className:"action-btn primary",children:[(0,n.jsx)("span",{className:"icon",children:"person_add"}),'Add "',f,'" as New Person']})]})}),0===f.length&&(0,n.jsxs)("div",{className:"search-help",children:[(0,n.jsx)("p",{children:"Start typing to search for existing people, or"}),(0,n.jsxs)("button",{onClick:()=>v(!0),className:"action-btn secondary",children:[(0,n.jsx)("span",{className:"icon",children:"person_add"}),"Add New Person"]})]})]}),g&&A&&(0,n.jsxs)("div",{className:"role-selection-form",children:[(0,n.jsxs)("h4",{children:["Select Role for ",A.first_name," ",A.last_name]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Role in Case"}),(0,n.jsxs)("select",{value:w,onChange:e=>S(e.target.value),children:[(0,n.jsx)("option",{value:"Parent",children:"Parent"}),(0,n.jsx)("option",{value:"Non-Resident Parent",children:"Non-Resident Parent"}),(0,n.jsx)("option",{value:"Client",children:"Client"}),(0,n.jsx)("option",{value:"Guardian",children:"Guardian"}),(0,n.jsx)("option",{value:"Relative",children:"Relative"}),(0,n.jsx)("option",{value:"Family Support",children:"Family Support"})]})]}),(0,n.jsxs)("div",{className:"form-actions",children:[(0,n.jsxs)("button",{onClick:()=>{G(A),N(!1),P(null)},className:"action-btn primary",children:[(0,n.jsx)("span",{className:"icon",children:"add"}),"Add to Case"]}),(0,n.jsx)("button",{onClick:()=>{N(!1),P(null)},className:"action-btn secondary",children:"Cancel"})]})]}),j&&(0,n.jsxs)("div",{className:"add-person-form",children:[(0,n.jsx)("h4",{children:"Add New Person"}),(0,n.jsxs)("div",{className:"form-grid",children:[(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"First Name *"}),(0,n.jsx)("input",{type:"text",value:R.first_name,onChange:e=>q({...R,first_name:e.target.value}),placeholder:"Enter first name"})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Last Name *"}),(0,n.jsx)("input",{type:"text",value:R.last_name,onChange:e=>q({...R,last_name:e.target.value}),placeholder:"Enter last name"})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Date of Birth"}),(0,n.jsx)("input",{type:"date",value:R.date_of_birth,onChange:e=>q({...R,date_of_birth:e.target.value})})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Relationship to Case *"}),(0,n.jsxs)("select",{value:R.role,onChange:e=>q({...R,role:e.target.value}),children:[(0,n.jsx)("option",{value:"Parent",children:"Parent"}),(0,n.jsx)("option",{value:"Non-Resident Parent",children:"Non-Resident Parent"}),(0,n.jsx)("option",{value:"Client",children:"Client"}),(0,n.jsx)("option",{value:"Guardian",children:"Guardian"}),(0,n.jsx)("option",{value:"Relative",children:"Relative"}),(0,n.jsx)("option",{value:"Family Support",children:"Family Support"})]})]})]}),(0,n.jsxs)("div",{className:"form-actions",children:[(0,n.jsxs)("button",{onClick:()=>{if(!R.first_name||!R.last_name){u("First name and last name are required");return}x([...p,{person_id:"temp_".concat(Date.now()),first_name:R.first_name,last_name:R.last_name,date_of_birth:R.date_of_birth,role:R.role.toLowerCase(),contact_info:{phone:void 0,email:void 0,address:void 0},indicators:[],relationship_to_primary_child:R.role}]),q({first_name:"",last_name:"",date_of_birth:"",role:"Parent"}),v(!1),u(null)},className:"action-btn primary",children:[(0,n.jsx)("span",{className:"icon",children:"add"}),"Add Person"]}),(0,n.jsx)("button",{onClick:()=>v(!1),className:"action-btn secondary",children:"Cancel"})]})]})]}),2===l&&(0,n.jsxs)("div",{className:"setup-step",children:[(0,n.jsx)("h3",{children:"Step 2: Confirm and Detail Allegations"}),(0,n.jsx)("p",{children:"Review and update the allegations for this case."}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Allegation Type *"}),(0,n.jsxs)("select",{value:I.type,onChange:e=>W({...I,type:e.target.value}),children:[(0,n.jsx)("option",{value:"",children:"Select allegation type"}),(0,n.jsx)("option",{value:"Physical Abuse",children:"Physical Abuse"}),(0,n.jsx)("option",{value:"Sexual Abuse",children:"Sexual Abuse"}),(0,n.jsx)("option",{value:"Emotional Abuse",children:"Emotional Abuse"}),(0,n.jsx)("option",{value:"Neglect",children:"Neglect"}),(0,n.jsx)("option",{value:"Medical Neglect",children:"Medical Neglect"}),(0,n.jsx)("option",{value:"Educational Neglect",children:"Educational Neglect"}),(0,n.jsx)("option",{value:"Abandonment",children:"Abandonment"}),(0,n.jsx)("option",{value:"Substance Abuse",children:"Substance Abuse"}),(0,n.jsx)("option",{value:"Domestic Violence",children:"Domestic Violence"})]})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Allegation Description *"}),(0,n.jsx)("textarea",{value:I.description,onChange:e=>W({...I,description:e.target.value}),placeholder:"Provide detailed description of the allegations...",rows:4})]})]}),3===l&&(0,n.jsxs)("div",{className:"setup-step",children:[(0,n.jsx)("h3",{children:"Step 3: Confirm Risk and Safety Assessments"}),(0,n.jsx)("p",{children:"Review the risk and safety assessments for this case."}),(0,n.jsxs)("div",{className:"assessment-section",children:[(0,n.jsx)("h4",{children:"Risk Assessment"}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Risk Level"}),(0,n.jsxs)("select",{value:T.risk_level,onChange:e=>D({...T,risk_level:e.target.value}),children:[(0,n.jsx)("option",{value:"Low",children:"Low Risk"}),(0,n.jsx)("option",{value:"Medium",children:"Medium Risk"}),(0,n.jsx)("option",{value:"High",children:"High Risk"})]})]}),(0,n.jsx)("div",{className:"form-group",children:(0,n.jsxs)("label",{children:[(0,n.jsx)("input",{type:"checkbox",checked:T.risk_confirmed,onChange:e=>D({...T,risk_confirmed:e.target.checked})}),"I confirm the risk assessment is accurate and complete"]})})]}),(0,n.jsxs)("div",{className:"assessment-section",children:[(0,n.jsx)("h4",{children:"Safety Assessment"}),(0,n.jsx)("div",{className:"form-group",children:(0,n.jsxs)("label",{children:[(0,n.jsx)("input",{type:"checkbox",checked:T.safety_confirmed,onChange:e=>D({...T,safety_confirmed:e.target.checked})}),"I confirm the safety assessment is accurate and complete"]})})]})]}),4===l&&(0,n.jsxs)("div",{className:"setup-step",children:[(0,n.jsx)("h3",{children:"Step 4: Request SWCM Assignment"}),(0,n.jsx)("p",{children:"Review all information and request assignment to a Social Work Case Manager."}),(0,n.jsxs)("div",{className:"setup-summary",children:[(0,n.jsx)("h4",{children:"Case Setup Summary"}),(0,n.jsxs)("div",{className:"summary-item",children:[(0,n.jsx)("strong",{children:"People Involved:"})," ",p.length," person(s)"]}),(0,n.jsxs)("div",{className:"summary-item",children:[(0,n.jsx)("strong",{children:"Allegation:"})," ",I.type]}),(0,n.jsxs)("div",{className:"summary-item",children:[(0,n.jsx)("strong",{children:"Risk Level:"})," ",T.risk_level]}),(0,n.jsxs)("div",{className:"summary-item",children:[(0,n.jsx)("strong",{children:"Assessments Confirmed:"})," ",T.risk_confirmed&&T.safety_confirmed?"Yes":"No"]})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"CPW Notes (Optional)"}),(0,n.jsx)("textarea",{value:M.cpw_notes,onChange:e=>E({...M,cpw_notes:e.target.value}),placeholder:"Add any additional notes for the SWCM...",rows:3})]}),(0,n.jsx)("div",{className:"form-group",children:(0,n.jsxs)("label",{children:[(0,n.jsx)("input",{type:"checkbox",checked:M.ready_for_assignment,onChange:e=>E({...M,ready_for_assignment:e.target.checked})}),"I confirm this case is ready for SWCM assignment"]})})]})]}),(0,n.jsx)("div",{className:"modal-footer",children:(0,n.jsxs)("div",{className:"modal-actions",children:[(0,n.jsx)("button",{onClick:a,className:"action-btn secondary",children:"Cancel"}),(0,n.jsxs)("button",{onClick:()=>{L(),a()},className:"action-btn tertiary",children:[(0,n.jsx)("span",{className:"icon",children:"save"}),"Save & Exit"]}),l>1&&(0,n.jsxs)("button",{onClick:()=>{l>1&&d(l-1)},className:"action-btn secondary",children:[(0,n.jsx)("span",{className:"icon",children:"arrow_back"}),"Previous"]}),l<4?(0,n.jsxs)("button",{onClick:()=>{l<4&&d(l+1)},className:"action-btn primary",disabled:!O[l-1].completed,children:["Next",(0,n.jsx)("span",{className:"icon",children:"arrow_forward"})]}):(0,n.jsxs)("button",{onClick:H,className:"action-btn primary",disabled:!M.ready_for_assignment||o,children:[o?"Processing...":"Complete Setup",(0,n.jsx)("span",{className:"icon",children:"check"})]})]})})]})}):null}function l(){let[e,s]=(0,r.useState)("cpw-queue"),[a,l]=(0,r.useState)([]),[d,o]=(0,r.useState)(!0),[h,m]=(0,r.useState)(null),[u,p]=(0,r.useState)(!1),[x,j]=(0,r.useState)(null);(0,r.useEffect)(()=>{v()},[]);let v=async()=>{o(!0),m(null);let e=await (0,t.tW)("unassigned");e.error?m(e.error):e.data&&l(e.data.cases),o(!1)},g=e=>{switch(e.toLowerCase()){case"allergy":return"medical_services";case"icwa eligible":return"diversity_3";case"runaway":return"directions_run";case"worker safety":return"security";case"protective order":return"gavel";case"icpc":return"swap_horiz";case"safe haven":return"shield";case"chronic medical condition":return"local_hospital";default:return"flag"}},N=e=>{switch(e.toLowerCase()){case"allergy":case"runaway":case"worker safety":return"error";case"icwa eligible":return"tertiary";case"protective order":case"chronic medical condition":return"secondary";default:return"primary"}},f=e=>e.persons?e.persons.filter(e=>"child"===e.role).map(e=>"".concat(e.first_name," ").concat(e.last_name)).join(", "):"",_=e=>{let s=new Set;return e.persons&&e.persons.forEach(e=>{e.indicators&&e.indicators.forEach(e=>s.add(e))}),Array.from(s)},y=e=>{j(e),p(!0)},b=e=>{try{let s=localStorage.getItem("cpw_setup_".concat(e));return null!==s}catch(e){return!1}},C=a.filter(s=>"cpw-queue"===e?"Case Setup"===s.status:"completed"===e?"Active"===s.status||"Closed"===s.status:"overdue"!==e);return d?(0,n.jsx)("div",{className:"page-container",children:(0,n.jsxs)("div",{className:"page-header",children:[(0,n.jsx)("h1",{className:"page-title",children:"CPW Dashboard"}),(0,n.jsx)("p",{className:"page-description",children:"Loading cases..."})]})}):(0,n.jsxs)("div",{className:"page-container",children:[(0,n.jsxs)("div",{className:"page-header",children:[(0,n.jsx)("h1",{className:"page-title",children:"CPW Dashboard"}),(0,n.jsx)("p",{className:"page-description",children:"Review and process cases requiring CPW attention"})]}),(0,n.jsxs)("div",{className:"content-wrapper",children:[(0,n.jsx)("div",{className:"tabs-container",children:(0,n.jsxs)("div",{className:"tabs",children:[(0,n.jsxs)("button",{className:"tab ".concat("cpw-queue"===e?"active":""),onClick:()=>s("cpw-queue"),children:[(0,n.jsx)("span",{className:"icon",children:"queue"}),"CPW Queue (",a.filter(e=>"Case Setup"===e.status).length,")"]}),(0,n.jsxs)("button",{className:"tab ".concat("completed"===e?"active":""),onClick:()=>s("completed"),children:[(0,n.jsx)("span",{className:"icon",children:"check_circle"}),"Completed (",a.filter(e=>"Active"===e.status||"Closed"===e.status).length,")"]}),(0,n.jsxs)("button",{className:"tab ".concat("overdue"===e?"active":""),onClick:()=>s("overdue"),children:[(0,n.jsx)("span",{className:"icon",children:"warning"}),"Overdue"]})]})}),(0,n.jsxs)("div",{className:"tab-content",children:["cpw-queue"===e&&(0,n.jsxs)("div",{className:"card",children:[(0,n.jsxs)("div",{className:"card-header",children:[(0,n.jsx)("h2",{children:"CPW Queue - Cases Requiring Setup"}),(0,n.jsxs)("div",{className:"card-actions",children:[(0,n.jsxs)("button",{className:"action-btn secondary",children:[(0,n.jsx)("span",{className:"icon",children:"filter_list"}),"Filter"]}),(0,n.jsxs)("button",{className:"action-btn primary",onClick:v,children:[(0,n.jsx)("span",{className:"icon",children:"refresh"}),"Refresh"]})]})]}),(0,n.jsxs)("div",{className:"card-content",children:[h&&(0,n.jsxs)("div",{className:"error-message",children:[(0,n.jsx)("span",{className:"icon",children:"error"}),h]}),C.length>0?(0,n.jsx)("div",{className:"table-container",children:(0,n.jsxs)("table",{className:"data-table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Case Name"}),(0,n.jsx)("th",{children:"Intake Date"}),(0,n.jsx)("th",{children:"Key Allegations"}),(0,n.jsx)("th",{children:"Children Involved"}),(0,n.jsx)("th",{children:"Indicators"}),(0,n.jsx)("th",{children:"Assigned Workers"}),(0,n.jsx)("th",{children:"Actions"})]})}),(0,n.jsx)("tbody",{children:C.map(e=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsxs)("div",{className:"case-name-cell",children:[(0,n.jsx)(i.default,{href:"/cases/".concat(e.case_id),className:"case-link",children:(0,n.jsx)("strong",{children:e.case_display_name||e.family_name})}),(0,n.jsx)("div",{className:"case-number",children:e.case_number})]})}),(0,n.jsx)("td",{children:new Date(e.created_date).toLocaleDateString()}),(0,n.jsx)("td",{children:(0,n.jsxs)("div",{className:"allegation-cell",children:[(0,n.jsx)("span",{className:"allegation-type",children:e.allegation_type}),(0,n.jsx)("div",{className:"allegation-desc",children:e.allegation_description})]})}),(0,n.jsx)("td",{children:(0,n.jsx)("div",{className:"children-list",children:f(e)||"No children listed"})}),(0,n.jsx)("td",{children:(0,n.jsxs)("div",{className:"indicators-cell",children:[_(e).slice(0,3).map((e,s)=>(0,n.jsxs)("span",{className:"indicator-badge ".concat(N(e)),title:e,children:[(0,n.jsx)("span",{className:"icon",children:g(e)}),e]},s)),_(e).length>3&&(0,n.jsxs)("span",{className:"indicator-more",children:["+",_(e).length-3," more"]})]})}),(0,n.jsx)("td",{children:(0,n.jsxs)("div",{className:"workers-cell",children:[(0,n.jsxs)("div",{className:"primary-worker",children:[(0,n.jsx)("strong",{children:"Primary:"})," ",e.assigned_worker||"Unassigned"]}),e.assigned_supervisor&&(0,n.jsxs)("div",{className:"supervisor",children:[(0,n.jsx)("strong",{children:"Supervisor:"})," ",e.assigned_supervisor]})]})}),(0,n.jsx)("td",{children:(0,n.jsxs)("div",{className:"action-buttons",children:[(0,n.jsxs)("button",{onClick:()=>y(e),className:"action-btn small primary",title:b(e.case_id)?"Resume saved progress":"Start case setup",children:[(0,n.jsx)("span",{className:"icon",children:b(e.case_id)?"play_arrow":"settings"}),b(e.case_id)?"Resume":"Setup"]}),(0,n.jsxs)("button",{className:"action-btn small secondary",children:[(0,n.jsx)("span",{className:"icon",children:"assignment"}),"Assign"]})]})})]},e.case_id))})]})}):(0,n.jsxs)("div",{className:"empty-state",children:[(0,n.jsx)("span",{className:"icon large",children:"queue"}),(0,n.jsx)("h3",{children:"No Cases in CPW Queue"}),(0,n.jsx)("p",{children:"All cases requiring setup have been processed"})]})]})]}),"completed"===e&&(0,n.jsxs)("div",{className:"card",children:[(0,n.jsxs)("div",{className:"card-header",children:[(0,n.jsx)("h2",{children:"Completed Cases"}),(0,n.jsxs)("div",{className:"card-actions",children:[(0,n.jsxs)("button",{className:"action-btn secondary",children:[(0,n.jsx)("span",{className:"icon",children:"filter_list"}),"Filter"]}),(0,n.jsxs)("button",{className:"action-btn primary",onClick:v,children:[(0,n.jsx)("span",{className:"icon",children:"refresh"}),"Refresh"]})]})]}),(0,n.jsxs)("div",{className:"card-content",children:[h&&(0,n.jsxs)("div",{className:"error-message",children:[(0,n.jsx)("span",{className:"icon",children:"error"}),h]}),C.length>0?(0,n.jsx)("div",{className:"table-container",children:(0,n.jsxs)("table",{className:"data-table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Case Name"}),(0,n.jsx)("th",{children:"Intake Date"}),(0,n.jsx)("th",{children:"Key Allegations"}),(0,n.jsx)("th",{children:"Children Involved"}),(0,n.jsx)("th",{children:"Indicators"}),(0,n.jsx)("th",{children:"Assigned Workers"}),(0,n.jsx)("th",{children:"Actions"})]})}),(0,n.jsx)("tbody",{children:C.map(e=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsxs)("div",{className:"case-name-cell",children:[(0,n.jsx)(i.default,{href:"/cases/".concat(e.case_id),className:"case-link",children:(0,n.jsx)("strong",{children:e.case_display_name||e.family_name})}),(0,n.jsx)("div",{className:"case-number",children:e.case_number})]})}),(0,n.jsx)("td",{children:new Date(e.created_date).toLocaleDateString()}),(0,n.jsx)("td",{children:(0,n.jsxs)("div",{className:"allegation-cell",children:[(0,n.jsx)("span",{className:"allegation-type",children:e.allegation_type}),(0,n.jsx)("div",{className:"allegation-desc",children:e.allegation_description})]})}),(0,n.jsx)("td",{children:(0,n.jsx)("div",{className:"children-list",children:f(e)||"No children listed"})}),(0,n.jsx)("td",{children:(0,n.jsxs)("div",{className:"indicators-cell",children:[_(e).slice(0,3).map((e,s)=>(0,n.jsxs)("span",{className:"indicator-badge ".concat(N(e)),title:e,children:[(0,n.jsx)("span",{className:"icon",children:g(e)}),e]},s)),_(e).length>3&&(0,n.jsxs)("span",{className:"indicator-more",children:["+",_(e).length-3," more"]})]})}),(0,n.jsx)("td",{children:(0,n.jsxs)("div",{className:"workers-cell",children:[(0,n.jsxs)("div",{className:"primary-worker",children:[(0,n.jsx)("strong",{children:"Primary:"})," ",e.assigned_worker||"Unassigned"]}),e.assigned_supervisor&&(0,n.jsxs)("div",{className:"supervisor",children:[(0,n.jsx)("strong",{children:"Supervisor:"})," ",e.assigned_supervisor]})]})}),(0,n.jsx)("td",{children:(0,n.jsxs)("div",{className:"action-buttons",children:[(0,n.jsxs)(i.default,{href:"/cases/".concat(e.case_id),className:"action-btn small primary",children:[(0,n.jsx)("span",{className:"icon",children:"visibility"}),"View"]}),(0,n.jsxs)("button",{className:"action-btn small secondary",children:[(0,n.jsx)("span",{className:"icon",children:"note_add"}),"Note"]})]})})]},e.case_id))})]})}):(0,n.jsxs)("div",{className:"empty-state",children:[(0,n.jsx)("span",{className:"icon large",children:"check_circle"}),(0,n.jsx)("h3",{children:"No Completed Cases"}),(0,n.jsx)("p",{children:"No cases have been sent for SWCM assignment yet"})]})]})]}),"overdue"===e&&(0,n.jsxs)("div",{className:"card",children:[(0,n.jsx)("div",{className:"card-header",children:(0,n.jsx)("h2",{children:"Overdue Cases"})}),(0,n.jsx)("div",{className:"card-content",children:(0,n.jsxs)("div",{className:"empty-state",children:[(0,n.jsx)("span",{className:"icon large",children:"warning"}),(0,n.jsx)("h3",{children:"No Overdue Cases"}),(0,n.jsx)("p",{children:"All cases are within required timeframes"})]})})]})]})]}),(0,n.jsx)(c,{isOpen:u,onClose:()=>{p(!1),j(null)},case_:x,onSuccess:()=>{p(!1),j(null),v()}})]})}},9116:function(e,s,a){"use strict";a.d(s,{$4:function(){return h},BY:function(){return t},Kj:function(){return m},k4:function(){return d},r$:function(){return o},tW:function(){return l},xL:function(){return c}});var n=a(7293);class r{async getAuthHeaders(){try{let e=n.I8.currentUser;if(e){let s=await e.getIdToken();return{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"}}}catch(e){console.warn("Failed to get auth token:",e)}return{"Content-Type":"application/json"}}async request(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let a="".concat(this.baseUrl).concat(e),n=await this.getAuthHeaders(),r=await fetch(a,{headers:{...n,...s.headers},...s});if(!r.ok)return{error:(await r.json().catch(()=>({}))).error||"HTTP ".concat(r.status,": ").concat(r.statusText)};return{data:await r.json()}}catch(e){return{error:e instanceof Error?e.message:"Unknown error occurred"}}}async getCasesPendingAssignment(){return this.request("/swcm/cases/pending-assignment")}async assignCaseToSWCM(e,s,a){return this.request("/swcm/cases/".concat(e,"/assign"),{method:"POST",body:JSON.stringify({assigned_worker:s,assigned_supervisor:a})})}async getCasesByWorker(e){return this.request("/cases?assigned_worker=".concat(encodeURIComponent(e)))}async getCaseById(e){return this.request("/cases/".concat(e))}async getPersonsByCase(e){return this.request("/cases/".concat(e,"/persons"))}async getCaseNotes(e){return this.request("/cases/".concat(e,"/notes"))}async addCaseNote(e,s,a){return this.request("/cases/".concat(e,"/notes"),{method:"POST",body:JSON.stringify({note_text:s,note_type:a||"General"})})}async updateCase(e,s){return this.request("/cases/".concat(e),{method:"PUT",body:JSON.stringify(s)})}async searchPersons(e){return this.request("/persons/search?q=".concat(encodeURIComponent(e)))}async healthCheck(){return this.request("/health")}constructor(e="https://ccwis-node-proxy-807576987550.us-central1.run.app"){this.baseUrl=e}}let i=new r,t=()=>i.getCasesPendingAssignment(),c=(e,s,a)=>i.assignCaseToSWCM(e,s,a),l=e=>i.getCasesByWorker(e),d=e=>i.getCaseById(e),o=(e,s,a)=>i.addCaseNote(e,s,a),h=(e,s)=>i.updateCase(e,s),m=e=>i.searchPersons(e)},7293:function(e,s,a){"use strict";a.d(s,{I8:function(){return t},Vv:function(){return c}});var n=a(738),r=a(2148);let i=(0,n.ZF)({projectId:"cw-vision-prototype",authDomain:"cw-vision-prototype.firebaseapp.com"}),t=(0,r.v0)(i),c=new r.hJ;c.setCustomParameters({hd:"google.com"})},7648:function(e,s,a){"use strict";a.d(s,{default:function(){return r.a}});var n=a(2972),r=a.n(n)}},function(e){e.O(0,[15,972,498,971,117,744],function(){return e(e.s=6315)}),_N_E=e.O()}]);